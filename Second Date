let
    // Function to extract the quarter from the date string
    ExtractQuarter = (description as text) as text =>
        let
            TextAfterTo = Text.AfterDelimiter(description, "to ", {0, RelativePosition.FromEnd}),
            GetQuarter = try 
                            if Text.Contains(TextAfterTo, "Q") then 
                                Text.Middle(TextAfterTo, Text.PositionOf(TextAfterTo, "Q"), 3)
                            else 
                                let
                                    MonthName = Text.Middle(TextAfterTo, 0, 3),
                                    Quarter = 
                                        if List.Contains({"Jan", "Feb", "Mar"}, MonthName) then "Q1" 
                                        else if List.Contains({"Apr", "May", "Jun"}, MonthName) then "Q2" 
                                        else if List.Contains({"Jul", "Aug", "Sep"}, MonthName) then "Q3" 
                                        else if List.Contains({"Oct", "Nov", "Dec"}, MonthName) then "Q4" 
                                        else null,
                                    Year = Text.Middle(TextAfterTo, Text.Length(TextAfterTo) - 4, 4),
                                    Result = Quarter & " '" & Year
                                in Result
                        otherwise null
        in 
            GetQuarter
in
    ExtractQuarter([Item transaction description])

